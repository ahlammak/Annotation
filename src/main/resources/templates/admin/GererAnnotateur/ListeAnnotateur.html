<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="template1">
<head>
    <meta charset="UTF-8">
    <title>Utilisateurs</title>
    <link rel="stylesheet" type="text/css" href="/webjars/bootstrap/5.3.3/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/webjars/bootstrap-icons/1.11.3/font/bootstrap-icons.css">
    <style>
        .container-custom {
            padding: 2rem;
        }
        .card-header {
            background-color: #0066cc;
            color: #fff;
            font-weight: bold;
        }
        .btn-ajouter {
            background-color: #28a745;
            color: #fff;
            font-weight: bold;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            margin-bottom: 1.5rem;
            display: inline-block;
        }
        .btn-ajouter:hover {
            background-color: #218838;
        }
        .table-striped tbody tr:hover {
            background-color: #e9ecef;
        }
        .pagination {
            justify-content: center;
            margin-top: 1.5rem;
        }
        .pagination .btn {
            margin: 0 0.3rem;
        } .alert-password {
                      background-color: #e0f7ff;
                      border-left: 4px solid #0099cc;
                      border-radius: 10px;
                      padding: 16px;
                      box-shadow: 0px 4px 8px rgba(0, 153, 204, 0.2);
                      transition: transform 0.3s ease, box-shadow 0.3s ease;
                  }

        .alert-password:hover {
            transform: translateY(-2px);
            box-shadow: 0px 6px 12px rgba(0, 153, 204, 0.3);
        }

        .alert-heading {
            color: #007bb5;
            font-weight: bold;
        }

        .password-value {
            background-color: #d1f0ff;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: bold;
        }

        .note {
            color: #cc3300;
            font-style: italic;
        }
    </style>
</head>
<body>
<div layout:fragment="content1">
    <div class="container-custom">
        <div class="card">
            <div class="card-header">
                Liste des Utilisateurs
            </div>
            <div th:if="${generatedPassword}" class="alert alert-password m-3">
                <h5 class="alert-heading"><i class="bi bi-check-circle me-2"></i>Nouvel utilisateur créé avec succès!</h5>
                <hr>
                <p><strong>Login:</strong> <span th:text="${newUser.login}" class="user-value"></span></p>
                <p><strong>Mot de passe:</strong> <code th:text="${generatedPassword}" class="password-value"></code></p>
            </div>

            <div class="card-body">
                <form method="get" th:action="@{/admin/ListeAnnotateur}" class="mb-3">
                    <div class="input-group">
                        <input type="text" name="keyword" class="form-control" placeholder="Rechercher..." th:value="${keyword}">
                        <input type="hidden" name="size" th:value="${size}">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-search"></i>
                        </button>
                    </div>
                </form>
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div>
                        <a th:href="@{/admin/addAnnotateur(keyword=${keyword},size=${size})}" class="btn-ajouter">+ Ajouter un Annotateur</a>
                        <span class="ms-3 text-muted" th:if="${totalItems > 0}">
                            <i class="bi bi-info-circle"></i>
                            <span th:text="${totalItems}"></span> annotateur(s) trouvé(s)
                        </span>
                    </div>
                </div>
                <div th:if="${totalItems == 0}" class="alert alert-info text-center my-4">
                    <i class="bi bi-info-circle-fill me-2"></i> Aucun annotateur trouvé. Vous pouvez en ajouter un nouveau en cliquant sur le bouton ci-dessus.
                </div>

                <table th:if="${totalItems > 0}" class="table table-striped table-bordered">
                    <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Nom</th>
                        <th>Prénom</th>
                        <th>Login</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="user:${listeAnnotateur}" th:if="${user.active}">
                        <td th:text="${user.ID}"></td>
                        <td th:text="${user.nom}"></td>
                        <td th:text="${user.prenom}"></td>
                        <td th:text="${user.login}"></td>
                        <td>
                            <a onclick="return confirm('Êtes-vous sûr de vouloir supprimer cet annotateur?')"
                               class="btn btn-sm btn-danger" title="Supprimer"
                               th:href="@{/deleteUser(id=${user.ID}, keyword=${keyword}, page=${currentPage}, size=${size})}">
                                <i class="bi bi-trash"></i>
                            </a>
                            <a class="btn btn-success"
                               th:href="@{/editUsers(id=${user.ID},keyword=${keyword},page=${currentPage},size=${size})}">
                                Modifier
                            </a>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <div class="pagination" th:if="${totalPages > 1}">
                    <ul class="nav">
                        <li th:each="page, status : ${pages}">
                            <a th:class="${status.index == currentPage ? 'btn btn-primary' : 'btn btn-outline-primary'}"
                               th:href="@{/admin/ListeAnnotateur(page=${status.index},keyword=${keyword},size=${size})}"
                               th:text="${1 + status.index}">
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
